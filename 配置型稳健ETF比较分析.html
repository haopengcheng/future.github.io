<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ETF 产品比较分析 (ETF Product Comparison)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&family=Noto+Sans+SC:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script> 
    <style>
        body {
            font-family: 'Inter', 'Noto Sans SC', sans-serif;
            background-color: #0a0f1f; /* Dark tech background */
            color: #e0e0e0;
            overflow-x: hidden; /* Prevent horizontal scroll */
        }

        .font-noto-sans-sc {
            font-family: 'Noto Sans SC', sans-serif;
        }

        .hero-section {
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .hero-bg-shape {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 120vw; /* Large visual element */
            height: 120vw;
            max-width: 1500px;
            max-height: 1500px;
            background: radial-gradient(circle, rgba(23, 87, 209, 0.2) 0%, rgba(23, 87, 209, 0) 60%);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            z-index: 0;
            animation: pulse-bg 10s infinite ease-in-out;
        }

        @keyframes pulse-bg {
            0% { transform: translate(-50%, -50%) scale(0.9); opacity: 0.7; }
            50% { transform: translate(-50%, -50%) scale(1.1); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(0.9); opacity: 0.7; }
        }

        .typewriter-text {
            font-size: 5vw; /* Responsive large font */
            font-weight: 900;
            color: #ffffff;
            letter-spacing: 2px;
            border-right: .15em solid #00d1ff; /* Bright accent for cursor */
            white-space: nowrap;
            overflow: hidden;
            animation: typing 3.5s steps(40, end), blink-caret .75s step-end infinite;
            z-index: 1;
        }

        @media (max-width: 768px) {
            .typewriter-text {
                font-size: 8vw;
            }
        }
         @media (min-width: 1200px) {
            .typewriter-text {
                font-size: 70px; /* Max font size */
            }
        }


        @keyframes typing {
            from { width: 0 }
            to { width: 100% }
        }

        @keyframes blink-caret {
            from, to { border-color: transparent }
            50% { border-color: #00d1ff; }
        }

        .section-title {
            margin-bottom: 2rem; /* More space for titles */
            text-align: center;
        }

        .section-title .chinese-title {
            font-size: 2.8rem; /* Larger Chinese title */
            font-weight: 900;
            color: #ffffff;
            display: block;
        }

        .section-title .english-subtitle {
            font-size: 1rem;
            font-weight: 400;
            color: #00d1ff; /* Accent color */
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 0.25rem;
            display: block;
        }
        
        @media (max-width: 768px) {
            .section-title .chinese-title {
                font-size: 2rem;
            }
            .section-title .english-subtitle {
                font-size: 0.8rem;
            }
        }

        .content-section {
            padding: 4rem 2rem; /* Increased padding */
            max-width: 1200px;
            margin: 0 auto;
            opacity: 0;
            transform: translateY(50px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }

        .content-section.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .etf-card {
            background-color: rgba(21, 28, 58, 0.6); /* Semi-transparent card bg */
            border: 1px solid rgba(0, 209, 255, 0.3); /* Accent border */
            border-radius: 16px; /* More rounded corners */
            padding: 2rem; /* Increased padding */
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            backdrop-filter: blur(10px); /* Frosted glass effect */
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .etf-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0, 209, 255, 0.2); /* Brighter glow on hover */
        }

        .etf-card h3 {
            font-size: 1.8rem; /* Larger card title */
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 0.5rem;
        }
        .etf-card .etf-code {
            font-size: 0.9rem;
            color: #00d1ff;
            margin-bottom: 1.5rem;
            display: block;
        }

        .metric {
            margin-bottom: 1rem;
        }
        .metric-label {
            font-size: 0.9rem;
            color: #a0a0a0;
            display: block;
            margin-bottom: 0.25rem;
        }
        .metric-value {
            font-size: 1.5rem; /* Larger metric value */
            font-weight: 700;
            color: #ffffff;
        }
        .metric-value.positive { color: #00ffaa; } /* Green for positive returns */
        .metric-value.negative { color: #ff4d4d; } /* Red for negative drawdown */

        .holdings-list {
            list-style: none;
            padding-left: 0;
            font-size: 0.9rem;
        }
        .holdings-list li {
            padding: 0.3rem 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .holdings-list li:last-child {
            border-bottom: none;
        }

        /* Chart Styling */
        .chart-container-wrapper {
            background-color: rgba(255,255,255,0.03);
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 1.5rem;
            border: 1px dashed rgba(0, 209, 255, 0.2);
        }
        .trend-chart-container { /* Specific container for trend chart to control height */
            height: 350px; /* Reduced height for trend chart */
            position: relative; /* Needed for Chart.js responsiveness */
        }
        .chart-title {
            text-align: center;
            color: #c0c0c0;
            font-size: 1rem;
            margin-bottom: 1rem;
        }
       
        .performance-drawdown-chart-style {
            display: flex;
            flex-direction: row; 
            justify-content: space-around; 
            align-items: flex-end; 
            height: 230px; 
            padding: 10px 0;
            margin-top: 1rem;
            border-radius: 8px;
        }

        .etf-bar-group { 
            display: flex;
            justify-content: center; 
            align-items: flex-end;
            gap: 8px; 
            flex-grow: 1; 
            position: relative; 
            height: 100%; 
        }

        .sector-bar-group-container { 
            display: flex;
            justify-content: space-around; 
            align-items: flex-start; 
            height: auto; 
            min-height: 250px; 
            padding: 10px 0;
            border-radius: 8px;
            margin-top: 1rem;
            gap: 15px; 
        }
        .etf-sector-bars { 
            display: flex;
            flex-direction: column; 
            align-items: center; 
            gap: 5px;
            width: calc(33% - 10px); 
        }
        .etf-sector-label {
            font-size: 0.85rem;
            color: #00d1ff;
            font-weight: bold;
            margin-bottom: 5px;
            text-align: center;
        }
        .sector-bar-item { 
            display: flex;
            align-items: center;
            width: 100%; 
            gap: 8px;
            margin-bottom: 3px;
        }
        .sector-bar {
            height: 18px; 
            opacity: 0.8;
            transition: width 0.5s ease-out, opacity 0.3s ease;
            border-radius: 3px;
            position: relative;
        }
        .sector-bar:hover {
            opacity: 1;
        }
        .sector-bar-label {
            font-size: 0.75rem;
            color: #b0b0b0;
            white-space: nowrap;
            flex-shrink: 0; 
        }
        .sector-bar-value {
            font-size: 0.75rem;
            color: #ffffff;
            font-weight: bold;
            margin-left: auto; 
        }


        .bar { 
            width: 30px; 
            opacity: 0.7;
            transition: height 0.5s ease-out, opacity 0.3s ease;
            position: relative;
            border-radius: 4px 4px 0 0;
        }
        .bar:hover {
            opacity: 1;
        }
        .bar-label { 
            position: absolute;
            bottom: -40px; 
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.7em; 
            color: #e0e0e0;
            white-space: nowrap;
            width: 120px; 
            text-align: center;
            line-height: 1.2;
        }
        .bar-value { 
            position: absolute;
            top: -22px; 
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.8em;
            color: #ffffff;
            font-weight: bold;
        }
        .bar.positive { background-color: #00ffaa; }
        .bar.negative { background-color: #ff4d4d; }


        .line-divider {
            height: 2px;
            width: 100px;
            background: linear-gradient(90deg, rgba(0,209,255,0), rgba(0,209,255,1) 50%, rgba(0,209,255,0) 100%);
            margin: 3rem auto; 
            opacity: 0.7;
        }
        
        .footer {
            text-align: center;
            padding: 2rem;
            margin-top: 3rem; 
            font-size: 0.8rem;
            color: #a0a0a0;
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        #backToTopBtn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background-color: rgba(0, 209, 255, 0.8); 
            color: white;
            border: none;
            border-radius: 50%; 
            width: 50px;
            height: 50px;
            font-size: 24px; 
            cursor: pointer;
            display: none; 
            z-index: 1000;
            transition: background-color 0.3s ease, opacity 0.3s ease, transform 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 209, 255, 0.3);
        }
        #backToTopBtn:hover {
            background-color: #00d1ff; 
            transform: scale(1.1);
        }

        .highlight-gradient {
            position: relative;
            padding: 0.5rem 1rem;
        }
        .highlight-gradient::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            border-radius: 8px;
            background: linear-gradient(to right, rgba(0, 209, 255, 0.3), rgba(0, 209, 255, 0.05));
            z-index: -1;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        .content-section.visible .highlight-gradient::before {
            opacity: 1;
        }
        .chart-legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px; 
            font-size: 0.8rem;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .legend-color-box {
            width: 12px;
            height: 12px;
            border-radius: 2px;
        }
         .etf-card-pie-chart svg { /* Ensure SVG scales within its container */
            max-width: 100%;
            height: auto;
        }

    </style>
</head>
<body>

    <section class="hero-section">
        <div class="hero-bg-shape"></div>
        <h1 class="typewriter-text font-noto-sans-sc">ETF智能对比分析</h1>
        <p class="text-xl md:text-2xl text-gray-300 mt-8 z-10 animate-fadeInUp" style="animation-delay: 3.6s;">
            深入洞察 <span class="text-[#00d1ff] font-bold">关键指标</span>，优化您的 <span class="text-[#00d1ff] font-bold">投资决策</span>
            <br>Deep dive into <span class="text-[#00d1ff] font-bold">key metrics</span>, optimize your <span class="text-[#00d1ff] font-bold">investment decisions</span>.
        </p>
        <div class="absolute bottom-10 text-3xl text-[#00d1ff] animate-bounce z-10">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-10 h-10">
              <path stroke-linecap="round" stroke-linejoin="round" d="m4.5 5.25 7.5 7.5 7.5-7.5M4.5 12l7.5 7.5 7.5-7.5" />
            </svg>          
        </div>
    </section>

    <section class="content-section">
        <div class="section-title">
            <span class="chinese-title font-noto-sans-sc">产品总览</span>
            <span class="english-subtitle">ETF Overview</span>
        </div>
        <p class="text-lg text-center text-gray-300 max-w-3xl mx-auto">
            本页面旨在对三款ETF产品：<strong class="text-[#00d1ff]">159201 (华夏国证自由现金流ETF)</strong>、<strong class="text-[#00d1ff]">159399 (国泰A股现金流聚焦ETF)</strong> 及 <strong class="text-[#00d1ff]">513530 (华泰柏瑞港股高股息ETF)</strong> 进行多维度对比分析，涵盖持仓、规模、收益与风险控制，助您做出更明智的投资选择。
        </p>
        <div class="line-divider"></div>
    </section>

    <section class="content-section">
        <div class="section-title">
            <span class="chinese-title font-noto-sans-sc">核心指标对比</span>
            <span class="english-subtitle">Key Metrics Comparison</span>
        </div>
        <div class="grid md:grid-cols-3 gap-8">
            <div class="etf-card">
                <div>
                    <h3 class="font-noto-sans-sc">华夏国证自由现金流ETF</h3>
                    <span class="etf-code">CODE: 159201</span>
                    <div class="metric">
                        <span class="metric-label">基金规模 (AUM)</span>
                        <span class="metric-value">¥120 亿 (模拟)</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">近三月收益率 (3M Return)</span>
                        <span class="metric-value negative">-0.94%</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">最大回撤 (3M Est. Drawdown)</span>
                        <span class="metric-value negative">-4.0%</span>
                    </div>
                    <div class="mt-4">
                        <span class="metric-label">主要持仓 (Top Holdings - 示例):</span>
                        <ul class="holdings-list" id="holdings-159201">
                            <li>美的集团: 1.31%</li>
                            <li>中国海油: 1.30%</li>
                            <li>中煤能源: 1.04%</li>
                            <li>潍柴动力: 0.95%</li>
                            <li>中国铝业: 0.82%</li>
                        </ul>
                    </div>
                </div>
                <div class="chart-container-wrapper mt-6 etf-card-pie-chart">
                    <p class="chart-title">主要持仓分布 (Top 3)</p>
                     <svg viewBox="0 0 100 100" class="w-32 h-32 mx-auto mt-2" id="pie-159201">
                        <circle cx="50" cy="50" r="40" fill="transparent" stroke="#777" stroke-width="10" stroke-dasharray="251.32 251.32" /> 
                        <circle cx="50" cy="50" r="40" fill="transparent" stroke="#00d1ff" stroke-width="10" data-slice="1"/> 
                        <circle cx="50" cy="50" r="40" fill="transparent" stroke="#33ffcc" stroke-width="10" data-slice="2"/> 
                        <circle cx="50" cy="50" r="40" fill="transparent" stroke="#66ccff" stroke-width="10" data-slice="3"/> 
                        <text x="50" y="55" text-anchor="middle" fill="#e0e0e0" font-size="8">TOP 3</text>
                    </svg>
                </div>
            </div>

            <div class="etf-card">
                <div>
                    <h3 class="font-noto-sans-sc">国泰A股现金流聚焦ETF</h3>
                    <span class="etf-code">CODE: 159399</span>
                    <div class="metric">
                        <span class="metric-label">基金规模 (AUM)</span>
                        <span class="metric-value">¥250 亿 (模拟)</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">近三月收益率 (3M Return)</span>
                        <span class="metric-value positive">+1.75%</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">最大回撤 (3M Est. Drawdown)</span>
                        <span class="metric-value negative">-5.0%</span>
                    </div>
                     <div class="mt-4">
                        <span class="metric-label">主要持仓 (Top Holdings - 示例):</span>
                        <ul class="holdings-list" id="holdings-159399">
                            <li>潍柴动力: 0.28%</li>
                            <li>大秦铁路: 0.26%</li>
                            <li>中国联通: 0.26%</li>
                            <li>格力电器: 0.25%</li>
                            <li>中国石油: 0.25%</li>
                        </ul>
                    </div>
                </div>
                <div class="chart-container-wrapper mt-6 etf-card-pie-chart">
                    <p class="chart-title">主要持仓分布 (Top 3)</p>
                     <svg viewBox="0 0 100 100" class="w-32 h-32 mx-auto mt-2" id="pie-159399">
                        <circle cx="50" cy="50" r="40" fill="transparent" stroke="#777" stroke-width="10" stroke-dasharray="251.32 251.32" />
                        <circle cx="50" cy="50" r="40" fill="transparent" stroke="#00d1ff" stroke-width="10" data-slice="1"/> 
                        <circle cx="50" cy="50" r="40" fill="transparent" stroke="#33ffcc" stroke-width="10" data-slice="2"/> 
                        <circle cx="50" cy="50" r="40" fill="transparent" stroke="#66ccff" stroke-width="10" data-slice="3"/> 
                        <text x="50" y="55" text-anchor="middle" fill="#e0e0e0" font-size="8">TOP 3</text>
                    </svg>
                </div>
            </div>

            <div class="etf-card">
                <div>
                    <h3 class="font-noto-sans-sc">华泰柏瑞港股高股息ETF</h3>
                    <span class="etf-code">CODE: 513530</span>
                    <div class="metric">
                        <span class="metric-label">基金规模 (AUM)</span>
                        <span class="metric-value">¥100 亿 (模拟)</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">近三月收益率 (3M Return)</span>
                        <span class="metric-value positive">+7.95%</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">最大回撤 (3M Est. Drawdown)</span>
                        <span class="metric-value negative">-10.0%</span>
                    </div>
                     <div class="mt-4">
                        <span class="metric-label">主要持仓 (Top Holdings - 示例):</span>
                        <ul class="holdings-list" id="holdings-513530">
                            <li>中远海控: 9.82%</li>
                            <li>兖煤澳大利亚: 5.91%</li>
                            <li>东方海外国际: 4.16%</li>
                            <li>国泰君安: 3.95%</li>
                            <li>中国海洋石油: 3.76%</li>
                        </ul>
                    </div>
                </div>
                <div class="chart-container-wrapper mt-6 etf-card-pie-chart">
                    <p class="chart-title">主要持仓分布 (Top 3)</p>
                     <svg viewBox="0 0 100 100" class="w-32 h-32 mx-auto mt-2" id="pie-513530">
                        <circle cx="50" cy="50" r="40" fill="transparent" stroke="#777" stroke-width="10" stroke-dasharray="251.32 251.32" />
                        <circle cx="50" cy="50" r="40" fill="transparent" stroke="#00d1ff" stroke-width="10" data-slice="1"/> 
                        <circle cx="50" cy="50" r="40" fill="transparent" stroke="#33ffcc" stroke-width="10" data-slice="2"/> 
                        <circle cx="50" cy="50" r="40" fill="transparent" stroke="#66ccff" stroke-width="10" data-slice="3"/> 
                        <text x="50" y="55" text-anchor="middle" fill="#e0e0e0" font-size="8">TOP 3</text>
                    </svg>
                </div>
            </div>
        </div>
    </section>

    <section class="content-section">
        <div class="section-title">
            <span class="chinese-title font-noto-sans-sc">ETF近三月走势对比</span>
            <span class="english-subtitle">Last 3 Months ETF Performance Trend (Simulated)</span>
        </div>
        <div class="chart-container-wrapper trend-chart-container">
            <p class="chart-title">模拟近三月累计收益率走势 (Simulated Last 3 Months Cumulative Return Trend)</p>
            <canvas id="etfTrendChart"></canvas>
        </div>
    </section>

    <section class="content-section">
        <div class="section-title">
            <span class="chinese-title font-noto-sans-sc">深度剖析</span>
            <span class="english-subtitle">In-depth Analysis</span>
        </div>
        
        <div class="highlight-gradient p-6 rounded-lg mb-12 bg-slate-800/30">
            <h4 class="text-2xl font-bold text-[#00d1ff] mb-3 font-noto-sans-sc">持仓组成 <span class="text-sm text-gray-400 uppercase">Holdings Breakdown</span></h4>
            <p class="text-gray-300 mb-4">
                华夏国证自由现金流ETF (159201) 和国泰A股现金流聚焦ETF (159399) 均专注于投资那些具有强劲且持续自由现金流能力的公司，通常这些公司财务状况较为健康。
                华泰柏瑞港股高股息ETF (513530) 则主要投资于香港市场中具有较高股息率的公司，旨在提供稳定的股息回报和潜在的资本增值。
            </p>
            <div class="chart-container-wrapper">
                <p class="chart-title">模拟持仓行业对比图 (Sector Allocation Comparison)</p>
                <div class="sector-bar-group-container" id="sectorAllocationChart">
                    </div>
            </div>
        </div>

        <div class="highlight-gradient p-6 rounded-lg mb-12 bg-slate-800/30">
            <h4 class="text-2xl font-bold text-[#00d1ff] mb-3 font-noto-sans-sc">业绩与回撤 <span class="text-sm text-gray-400 uppercase">Performance & Drawdown</span></h4>
            <p class="text-gray-300 mb-4">
                根据近三月模拟数据，国泰A股现金流聚焦ETF (159399) 和华泰柏瑞港股高股息ETF (513530) 表现出正收益，而华夏国证自由现金流ETF (159201)略有回调。各ETF的回撤控制也各有特点，具体数据请参考下方图表。
            </p>
            <div class="chart-container-wrapper">
                <p class="chart-title">近三月业绩与最大回撤对比 (3M Return & Max Drawdown)</p>
                <div class="performance-drawdown-chart-style" id="performanceDrawdownChart">
                    </div>
                <div class="chart-legend">
                    <div class="legend-item">
                        <div class="legend-color-box" style="background-color: #00ffaa;"></div>
                        <span>收益率 (Return)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color-box" style="background-color: #ff4d4d;"></div>
                        <span>最大回撤 (Max Drawdown)</span>
                    </div>
                </div>
            </div>

        </div>
        <div class="line-divider"></div>
    </section>

    <section class="content-section">
        <div class="section-title">
            <span class="chinese-title font-noto-sans-sc">投资建议</span>
            <span class="english-subtitle">Investment Suggestions</span>
        </div>
        <div class="bg-slate-800/50 border border-sky-500/30 p-8 rounded-xl shadow-2xl">
            <ul class="list-disc list-inside space-y-4 text-gray-300 text-lg">
                <li>
                    <strong class="text-[#00d1ff]">注重A股市场现金流质量的投资者：</strong>可关注 <strong class="text-white">华夏国证自由现金流ETF (159201)</strong> 和 <strong class="text-white">国泰A股现金流聚焦ETF (159399)</strong>。这类ETF通常投资于A股中基本面扎实、能够持续产生自由现金流的公司。
                </li>
                <li>
                    <strong class="text-[#00d1ff]">寻求港股市场高股息回报的投资者：</strong><strong class="text-white">华泰柏瑞港股高股息ETF (513530)</strong> 专注于香港市场的高股息股票，适合追求稳定现金分红的投资者。
                </li>
                <li>
                    <strong class="text-[#00d1ff]">风险偏好与市场选择：</strong> 投资者应结合自身风险承受能力，以及对A股和港股市场的不同预期来选择。现金流策略通常被认为相对稳健，而高股息策略则侧重于股息收入。
                </li>
            </ul>
            <p class="mt-6 text-sm text-amber-400/80">
                重要提示：以上建议仅基于模拟数据和一般市场情况分析，不构成任何具体的投资操作指引。投资有风险，入市需谨慎。请在充分了解产品特性和自身风险承受能力后做出决策。
            </p>
        </div>
    </section>

    <footer class="footer">
        <p>友情提示：本页内容仅作参考。</p>
        <p>&copy; 2025 ETF Analysis Platform. All rights reserved.</p>
    </footer>

    <button id="backToTopBtn" title="返回顶部 (Back to Top)">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6 mx-auto">
          <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 10.5 12 3m0 0 7.5 7.5M12 3v18" />
        </svg>
    </button>

    <script>
        // Scroll-triggered Animations
        const sections = document.querySelectorAll('.content-section');
        const observerOptions = {
            root: null, 
            rootMargin: '0px',
            threshold: 0.1 
        };

        const observerCallback = (entries, obs) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                    if (entry.target.contains(document.getElementById('etfTrendChart')) && typeof initEtfTrendChart === 'function' && !window.etfTrendChartInitialized) {
                        initEtfTrendChart();
                        window.etfTrendChartInitialized = true; 
                    }
                    if (entry.target.contains(document.getElementById('sectorAllocationChart')) && typeof initSectorAllocationChart === 'function' && !window.sectorAllocationChartInitialized) {
                        initSectorAllocationChart();
                        window.sectorAllocationChartInitialized = true;
                    }
                    if (entry.target.contains(document.getElementById('performanceDrawdownChart')) && typeof initPerformanceDrawdownChart === 'function' && !window.performanceDrawdownChartInitialized) {
                        initPerformanceDrawdownChart();
                        window.performanceDrawdownChartInitialized = true;
                    }
                }
            });
        };
        const sectionObserver = new IntersectionObserver(observerCallback, observerOptions);
        sections.forEach(section => {
            sectionObserver.observe(section);
        });


        const backToTopBtn = document.getElementById('backToTopBtn');
        window.onscroll = function() {
            if (document.body.scrollTop > 100 || document.documentElement.scrollTop > 100) {
                if (backToTopBtn.style.display !== "block") { 
                    backToTopBtn.style.display = "block";
                    requestAnimationFrame(() => { backToTopBtn.style.opacity = "1"; });
                }
            } else {
                if (backToTopBtn.style.opacity === "1") { 
                    backToTopBtn.style.opacity = "0";
                    setTimeout(() => { 
                        if(!(document.body.scrollTop > 100 || document.documentElement.scrollTop > 100)) {
                            backToTopBtn.style.display = "none"; 
                        }
                    }, 300);
                }
            }
        };
        backToTopBtn.onclick = function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        };

        if (typeof Chart !== 'undefined') {
            Chart.defaults.font.family = "'Inter', 'Noto Sans SC', sans-serif";
            Chart.defaults.color = '#e0e0e0'; 
            Chart.defaults.borderColor = 'rgba(255, 255, 255, 0.1)'; 
        }

        function initEtfTrendChart() {
            const etfTrendCtx = document.getElementById('etfTrendChart')?.getContext('2d');
            if (!etfTrendCtx) return;

            const labels = ["2月底", "3月初", "3月中", "3月底", "4月初", "4月中", "4月底", "5月初", "5月中", "5月底"];
            const etf159201Data = [0, -1, 0, -1.5, -2, -4, -3, -2, -1, -0.94];      
            const etf159399Data = [0, 0.5, 1.5, 1, -2, -5, -1, 0, 1, 1.75];       
            const etf513530Data = [0, 1, 3, 2, -3, -8, -1, 3, 6, 7.95];         

            new Chart(etfTrendCtx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: '159201 (华夏国证自由现金流)',
                            data: etf159201Data,
                            borderColor: '#3b82f6', 
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            tension: 0.3,
                            fill: false,
                            borderWidth: 2
                        },
                        {
                            label: '159399 (国泰A股现金流聚焦)',
                            data: etf159399Data,
                            borderColor: '#22c55e', 
                            backgroundColor: 'rgba(34, 197, 94, 0.1)',
                            tension: 0.3,
                            fill: false,
                            borderWidth: 2
                        },
                        {
                            label: '513530 (华泰柏瑞港股高股息)',
                            data: etf513530Data,
                            borderColor: '#f59e0b', 
                            backgroundColor: 'rgba(245, 158, 11, 0.1)',
                            tension: 0.3,
                            fill: false,
                            borderWidth: 2
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false, // Important for canvas to respect container height
                    animation: { duration: 1000, easing: 'easeInOutQuart' },
                    scales: {
                        y: { 
                            min: -12, // Adjusted Y-axis min
                            max: 12,  // Adjusted Y-axis max
                            ticks: { callback: function(value) { return value + '%';}, color: '#a0a0a0'}, 
                            grid: {color: 'rgba(255, 255, 255, 0.08)', drawBorder: false}
                        },
                        x: { ticks: { color: '#a0a0a0'}, grid: {display: false}}
                    },
                    plugins: {
                        legend: { position: 'top', labels: {color: '#e0e0e0', usePointStyle: true, boxWidth: 8}},
                        tooltip: {
                            mode: 'index', intersect: false, backgroundColor: 'rgba(10, 15, 31, 0.85)', titleFont: {weight: 'bold'}, bodyFont: {size: 12}, padding: 10, cornerRadius: 6,
                            callbacks: { label: function(context) { let label = context.dataset.label || ''; if (label) { label += ': '; } if (context.parsed.y !== null) { label += context.parsed.y.toFixed(2) + '%'; } return label;}}
                        }
                    },
                    interaction: { mode: 'nearest', axis: 'x', intersect: false }
                }
            });
        }
        window.etfTrendChartInitialized = false;

        function initPerformanceDrawdownChart() {
            const performanceDrawdownData = [
                { etf: '159201', name: '华夏国证自由现金流', returnValue: -0.94, drawdownValue: -4.0 },
                { etf: '159399', name: '国泰A股现金流聚焦', returnValue: 1.75, drawdownValue: -5.0 },
                { etf: '513530', name: '华泰柏瑞港股高股息', returnValue: 7.95, drawdownValue: -10.0 }
            ];

            const chartContainer = document.getElementById('performanceDrawdownChart');
            if (!chartContainer) return;
            
            const allValues = performanceDrawdownData.flatMap(d => [Math.abs(d.returnValue), Math.abs(d.drawdownValue)]);
            const maxValue = Math.max(...allValues, 10); 

            performanceDrawdownData.forEach(data => {
                const group = document.createElement('div');
                group.classList.add('etf-bar-group');

                const returnBar = document.createElement('div');
                returnBar.classList.add('bar', data.returnValue >= 0 ? 'positive' : 'negative');
                const returnHeight = Math.max(0, (Math.abs(data.returnValue) / maxValue) * 100); 
                
                const returnValueDisplay = document.createElement('span');
                returnValueDisplay.classList.add('bar-value');
                returnValueDisplay.textContent = `${data.returnValue.toFixed(1)}%`;
                returnBar.appendChild(returnValueDisplay);

                const returnLabel = document.createElement('span');
                returnLabel.classList.add('bar-label');
                returnLabel.innerHTML = `${data.name}<br>(${data.etf} 收益)`;
                returnBar.appendChild(returnLabel);
                group.appendChild(returnBar);

                const drawdownBar = document.createElement('div');
                drawdownBar.classList.add('bar', 'negative');
                const drawdownHeight = Math.max(0, (Math.abs(data.drawdownValue) / maxValue) * 100);
                const drawdownValueDisplay = document.createElement('span');
                drawdownValueDisplay.classList.add('bar-value');
                drawdownValueDisplay.textContent = `${data.drawdownValue.toFixed(1)}%`;
                drawdownBar.appendChild(drawdownValueDisplay);
                group.appendChild(drawdownBar);
                
                chartContainer.appendChild(group);
                
                requestAnimationFrame(() => {
                    setTimeout(() => {
                         returnBar.style.height = `${returnHeight}%`;
                         drawdownBar.style.height = `${drawdownHeight}%`;
                    }, 100); 
                });
            });
        }
        window.performanceDrawdownChartInitialized = false;

        function initSectorAllocationChart() {
            const sectorAllocationData = [
                { 
                    etf: '159201', name: '华夏国证自由现金流',
                    sectors: [
                        { name: '家电耐用消费', value: 15, color: '#22c55e' }, 
                        { name: '能源化工', value: 20, color: '#3b82f6' }, 
                        { name: '工业机械', value: 18, color: '#f97316' }, 
                        { name: '通信设备', value: 12, color: '#8b5cf6' }, 
                        { name: '汽车制造', value: 10, color: '#ec4899'}, 
                        { name: '其他', value: 25, color: '#71717a' }      
                    ]
                },
                { 
                    etf: '159399', name: '国泰A股现金流聚焦',
                    sectors: [
                        { name: '交通运输', value: 15, color: '#3b82f6' }, 
                        { name: '工业制造', value: 20, color: '#22c55e' },
                        { name: '能源材料', value: 18, color: '#8b5cf6' },
                        { name: '电信服务', value: 12, color: '#f97316' },
                        { name: '耐用消费品', value: 10, color: '#14b8a6'}, 
                        { name: '其他', value: 25, color: '#71717a' }
                    ]
                },
                { 
                    etf: '513530', name: '华泰柏瑞港股高股息',
                    sectors: [
                        { name: '航运物流', value: 20, color: '#6366f1' }, 
                        { name: '能源矿产', value: 18, color: '#3b82f6' },
                        { name: '银行金融', value: 25, color: '#ef4444' }, 
                        { name: '工业制造(港)', value: 10, color: '#f59e0b' }, 
                        { name: '其他高股息', value: 27, color: '#71717a' }
                    ]
                }
            ];

            const chartContainer = document.getElementById('sectorAllocationChart');
            if (!chartContainer) return;
            
            const maxSectorValue = 100; 

            sectorAllocationData.forEach((etfData, etfIndex) => {
                const etfGroupDiv = document.createElement('div');
                etfGroupDiv.classList.add('etf-sector-bars');
                
                const etfNameLabel = document.createElement('div');
                etfNameLabel.classList.add('etf-sector-label');
                etfNameLabel.textContent = `${etfData.name} (${etfData.etf})`;
                etfGroupDiv.appendChild(etfNameLabel);

                etfData.sectors.forEach((sector) => {
                    const itemDiv = document.createElement('div');
                    itemDiv.classList.add('sector-bar-item');
                    const barDiv = document.createElement('div');
                    barDiv.classList.add('sector-bar');
                    barDiv.style.backgroundColor = sector.color; 
                    const barWidth = Math.max(0, (sector.value / maxSectorValue) * 100); 
                    const labelSpan = document.createElement('span');
                    labelSpan.classList.add('sector-bar-label');
                    labelSpan.textContent = sector.name;
                    const valueSpan = document.createElement('span');
                    valueSpan.classList.add('sector-bar-value');
                    valueSpan.textContent = `${sector.value}%`;
                    itemDiv.appendChild(barDiv); 
                    itemDiv.appendChild(labelSpan);
                    itemDiv.appendChild(valueSpan);
                    etfGroupDiv.appendChild(itemDiv);
                    requestAnimationFrame(() => {
                        setTimeout(() => { barDiv.style.width = `${barWidth}%`; }, 100 + etfIndex * 50 + Math.random() * 50); 
                    });
                });
                chartContainer.appendChild(etfGroupDiv);
            });
        }
        window.sectorAllocationChartInitialized = false;

        // Function to update ETF card pie charts
        function updateSvgPieChart(etfCode, topHoldingsPercentages) {
            const pieSvg = document.getElementById(`pie-${etfCode}`);
            if (!pieSvg) return;

            const slices = pieSvg.querySelectorAll('circle[data-slice]');
            const circumference = 2 * Math.PI * 40; // Radius is 40
            let accumulatedOffset = 0;

            slices.forEach((slice, index) => {
                if (index < topHoldingsPercentages.length) {
                    const percentage = topHoldingsPercentages[index];
                    const dashArrayValue = (percentage / 100) * circumference;
                    const remaining = circumference - dashArrayValue;
                    
                    slice.setAttribute('stroke-dasharray', `${dashArrayValue} ${remaining}`);
                    slice.setAttribute('stroke-dashoffset', `-${accumulatedOffset}`);
                    accumulatedOffset += dashArrayValue;
                } else { // Hide extra slices if not enough data
                    slice.setAttribute('stroke-dasharray', `0 ${circumference}`);
                }
            });
        }

        // Initialize ETF Card Pie Charts
        function initCardPieCharts() {
            // ETF 159201 Data (Top 3 from list)
            const holdings159201 = [1.31, 1.30, 1.04]; 
            updateSvgPieChart('159201', holdings159201);

            // ETF 159399 Data (Top 3 from list)
            const holdings159399 = [0.28, 0.26, 0.26];
            updateSvgPieChart('159399', holdings159399);

            // ETF 513530 Data (Top 3 from list)
            const holdings513530 = [9.82, 5.91, 4.16];
            updateSvgPieChart('513530', holdings513530);
        }
        
        // Call pie chart initialization when the relevant section is visible, or on DOMContentLoaded
        // For simplicity, let's call it when the script runs, assuming cards are visible or will become visible.
        // More robust would be to tie it to the IntersectionObserver for the .etf-card elements.
        document.addEventListener('DOMContentLoaded', initCardPieCharts);


        const styleSheet = document.createElement("style");
        styleSheet.type = "text/css";
        styleSheet.innerText = `
            @keyframes fadeInUp {
                from { opacity: 0; transform: translateY(20px); }
                to { opacity: 1; transform: translateY(0); }
            }
            .animate-fadeInUp { animation: fadeInUp 1s ease-out forwards; }
        `;
        document.head.appendChild(styleSheet);

    </script>
</body>
</html>
